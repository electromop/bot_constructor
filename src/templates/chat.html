<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <style>
        .body-grey {
            background-color: #f0f0f0;
        }

        .input-form {
            margin-bottom: auto;
        }

        .card {
            background-color: #f0f0f0;
            border: 0;
            height: 100vh;
        }
        .chat-container {
            background-color: #f0f0f0;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .message {
            border-radius: 25px;
            padding: 15px;
            margin-bottom: 15px;
            opacity: 0; /* –Ω–∞—á–∞–ª—å–Ω–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ */
            animation: fadeIn 0.5s ease-out forwards;
        }

        .received {
            background-color: white;
            text-align: left;
            animation: slideInLeft 0.5s ease-out forwards, fadeIn 0.5s ease-out forwards;
        }

        .sent {
            background-color: #5ca6fa;
            color: white;
            text-align: right;
            animation: slideInRight 0.5s ease-out forwards, fadeIn 0.5s ease-out forwards;
        }

        .btn-rounded {
            border-radius: 20px;
        }

        .input-form {
            margin-top: 15px;
        }

        @keyframes slideInLeft {
            from {
                transform: translateX(-100%);
            }
            to {
                transform: translateX(0);
            }
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
            }
            to {
                transform: translateX(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
    </style>
    <title>–ß–∞—Ç –≤ —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏</title>
</head>
<body class="body-grey">

<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="card mt-5">
                <div class="card-body">
                    <div class="chat-container">
                        <!-- –ü—Ä–∏–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
                        <div class="message received">
                            <p>–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞–∫ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å–æ–∑–¥–∞—Ç—å –±–æ—Ç–∞</p>
                            <div class="mt-3">
                                <button type="button" class="btn btn-primary mr-2 btn-rounded">–ù–∞—á–∞—Ç—å —Å —á–∏—Å—Ç–æ–≥–æ –ª–∏—Å—Ç–∞</button>
                                <button type="button" class="btn btn-primary btn-rounded" id="generateBotBtn">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –±–æ—Ç–∞</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

<script>
    document.getElementById('generateBotBtn').addEventListener('click', function() {
        var chatContainer = document.querySelector('.chat-container');

        // –≠–º—É–ª–∏—Ä—É–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        var userMessage = document.createElement('div');
        userMessage.className = 'message sent';
        userMessage.innerHTML = '<p>–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –±–æ—Ç–∞</p>';
        chatContainer.appendChild(userMessage);

        setTimeout(function() {
            // –≠–º—É–ª–∏—Ä—É–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç —Å–∞–π—Ç–∞
            var siteMessage = document.createElement('div');
            siteMessage.className = 'message received';
            siteMessage.innerHTML = '<p>–û–ø–∏—à–∏—Ç–µ —Å–≤–æ–π –±–∏–∑–Ω–µ—Å –∏–ª–∏ –±–æ—Ç–∞, –∫–æ—Ç–æ—Ä–æ–≥–æ –≤—ã –±—ã —Ö–æ—Ç–µ–ª–∏.</p>';
            chatContainer.appendChild(siteMessage);

        }, 1000); // –ó–∞–¥–µ—Ä–∂–∫–∞ –≤ 1 —Å–µ–∫—É–Ω–¥—É (1000 –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥)
        setTimeout(function() {
          // –î–æ–±–∞–≤–ª—è–µ–º —Ñ–æ—Ä–º—É –¥–ª—è –≤–≤–æ–¥–∞ –æ–ø–∏—Å–∞–Ω–∏—è –±–æ—Ç–∞
          var inputForm = document.createElement('div');
          inputForm.className = 'input-form';
          inputForm.innerHTML = '<form><div class="form-group"><label for="botDescription"></label><textarea class="form-control" id="botDescription" rows="3" placeholder="–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –±–æ—Ç–∞"></textarea></div><button type="submit" class="btn btn-primary btn-rounded">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button></form>';
          chatContainer.appendChild(inputForm);
        }, 2000); // –ó–∞–¥–µ—Ä–∂–∫–∞ –≤ 1 —Å–µ–∫—É–Ω–¥—É (1000 –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥)
    });
    
    document.addEventListener('submit', function(event) {
        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É —Ñ–æ—Ä–º—ã, —á—Ç–æ–±—ã —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–ª–∞—Å—å
        event.preventDefault();
		
        var chatContainer = document.querySelector('.chat-container');
        
		// –£–¥–∞–ª—è–µ–º —Ñ–æ—Ä–º—É –¥–ª—è –≤–≤–æ–¥–∞ –æ–ø–∏—Å–∞–Ω–∏—è –±–æ—Ç–∞
        var inputForm = document.querySelector('.input-form');
        userMessageText = document.getElementById('botDescription').value;
        window.currentUser = {
            message: userMessageText
        };
        if (inputForm) {
            inputForm.remove();
        }
        
        goToBot();
        
        var userMessage = document.createElement('div');
        userMessage.className = 'message sent';
        userMessage.innerHTML = userMessageText;
        chatContainer.appendChild(userMessage);
        
        setTimeout(function() {
            // –≠–º—É–ª–∏—Ä—É–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç —Å–∞–π—Ç–∞
            var siteMessage = document.createElement('div');
            siteMessage.className = 'message received';
            siteMessage.id = 'to_edit';
            siteMessage.innerHTML = '‚úÖ–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤–∞—à –∑–∞–ø—Ä–æ—Å...';
            chatContainer.appendChild(siteMessage);
        }, 1000); // –ó–∞–¥–µ—Ä–∂–∫–∞ –≤ 1 —Å–µ–∫—É–Ω–¥—É (1000 –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥)

        var messagesList = [
            '<p class="line-1 anim-typewriter">üîÆ –ì–∞–¥–∞–µ–º –Ω–∞ –∫–æ—Ñ–µ–π–Ω–æ–π –≥—É—â–µ...</p>',
            '<p class="line-1 anim-typewriter">üìù –ß—Ç–æ –∂–µ –í—ã —Ç—É—Ç –ø–æ–Ω–∞–ø–∏—Å–∞–ª–∏...</p>',
            '<p class="line-1 anim-typewriter">‚è≥ –ï—â–µ –Ω–µ–º–Ω–æ–≥–æ...</p>',
            '<p class="line-1 anim-typewriter">üê± –û–∂–∏–¥–∞–µ–º –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è –æ—Ç –∫–æ—Ç–∏–∫–∞...</p>',
            '<p class="line-1 anim-typewriter">üöÄ –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ—Å–º–∏—á–µ—Å–∫–∏–π —á–∞–π...</p>',
            '<p class="line-1 anim-typewriter">ü§î –ñ–¥–µ–º, –∫–æ–≥–¥–∞ –≤–∞—à–∏ –º—ã—Å–ª–∏ –ø–µ—Ä–µ–±–µ—Ä—É—Ç—Å—è –≤ –∫–æ–¥...</p>',
            '<p class="line-1 anim-typewriter">üëã –ö–∞–∫ –≤–∞—à–∏ –¥–µ–ª–∞? –ü–æ–∫–∞ –æ—Ç–≤–µ—Ç–∏—Ç–µ, –º—ã –∑–∞–≥—Ä—É–∑–∏–º—Å—è...</p>',
            '<p class="line-1 anim-typewriter">üïµÔ∏è‚Äç‚ôÄÔ∏è –ò—â–µ–º –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã–µ –±–∏—Ç—ã –∏ –±–∞–π—Ç—ã...</p>',
            '<p class="line-1 anim-typewriter">üò∫ –ö–æ—Ç–∏–∫–∏ –≥–æ—Ç–æ–≤—ã –∫ –∑–∞–≥—Ä—É–∑–∫–µ –≤–µ—Å–µ–ª—å—è...</p>',
            '<p class="line-1 anim-typewriter">üòÇ –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–º–µ—Ö–æ–ø–∞–Ω–æ—Ä–∞–º—É... –í–µ—Å–µ–ª—å–µ –Ω–∞—á–Ω–µ—Ç—Å—è —á–µ—Ä–µ–∑ –º–≥–Ω–æ–≤–µ–Ω–∏–µ!</p>',
            '<p class="line-1 anim-typewriter">üí° –ñ–¥–µ–º –≤–∞—à–∏—Ö –º—ã—Å–ª–µ–π, —á—Ç–æ–±—ã –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –∏—Ö –≤ —Ü–∏—Ñ—Ä—ã...</p>',
            '<p class="line-1 anim-typewriter">‚òÅÔ∏è –ü–æ–∫–∞ –∫–æ–≤—ã—Ä—è–µ–º –ø–∞–ª—å—Ü–µ–º –≤ –æ–±–ª–∞–∫–∞—Ö, –∑–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç...</p>',
            '<p class="line-1 anim-typewriter">‚ùì –ß—Ç–æ –±—É–¥–µ—Ç, –µ—Å–ª–∏ –∫–ª–∏–∫–Ω—É—Ç—å –º—ã—à—å—é 1000 —Ä–∞–∑? –î–∞–≤–∞–π—Ç–µ —É–∑–Ω–∞–µ–º!</p>'
        ];

        setTimeout(() => {
            var siteMessage = document.getElementById('to_edit');
            // siteMessage.classList.add('line-1 anim-typewriter');
            for (let i = 0; i <= messagesList.length - 1; i++) {
            setTimeout(() => {
                siteMessage.innerHTML = messagesList[Math.floor(Math.random() * messagesList.length)];
                chatContainer.appendChild(siteMessage);
            }, i * 3500)
        }
        }, 4500)
    });

    function getCurrentBotInfo() {
            botToken = window.location.pathname.replace('/ai_chat', '');
            botToken = botToken.replace('/', '')
            console.log(botToken);
            return botToken;
        }

    async function goToBot() {
        var botPath = getCurrentBotInfo();
        var request = encodeURI(currentUser.message);
        console.log(`http://127.0.0.1:5000/${botPath}/ai/gen_bot/${request}`);
        await window.location.replace(`http://127.0.0.1:5000/${botPath}/ai/gen_bot/${request}`);
    };
</script>

</body>
</html>